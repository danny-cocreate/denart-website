---
import BaseLayout from '../layouts/BaseLayout.astro';
import SectionHeader from '../components/SectionHeader.astro';

interface Testimonial {
  name: string;
  quote: string;
}

// Extract source from name field (e.g., "Name (Yelp)" -> "Yelp")
function extractSource(name: string): { displayName: string; source: string } {
  const match = name.match(/^(.+?)\s*\((.+?)\)$/);
  if (match) {
    return { displayName: match[1].trim(), source: match[2].trim() };
  }
  return { displayName: name, source: 'Google' };
}

const eventTestimonials: Testimonial[] = [
  { name: "Camoy Briscoe", quote: "Thanks again for doing the job last minute. The girls looked amazing!!" },
  { name: "Howard Haber", quote: "Spectacular! You and your models are both classy and amazing! So perfect! You definately made a few fans but I lead the pack. Just amazing. Thank you!" },
  { name: "Shallini M (Yelp)", quote: "Danny is a very talented painter who painted two models at my husband's 40th Birthday party. He put a great deal of thought and care into the details. Everyone at the party loved watching him paint. Danny accomodated a special request of ours to paint a famous piece of art that he had not done before which came out amazing." },
  { name: "Rebecca Bilger, The ONE Group", quote: "Thanks so much! The girls looked/were fantastic! I will definitely keep you posted on upcoming events." },
  { name: "Seema Gupta", quote: "I can never forget what a Hit your body painting was at my party last year. I wish you all the luck in the world and hope you keep making progress" },
  { name: "Soren Meischeid, Yoga Rave", quote: "Thank YOU for bringing the color and glow! You guys were a big hit! And I'm so glad you were able to join us." },
  { name: "Samantha A, Kobo", quote: "Thanks so much for helping make our event special, you did a great job!" },
];

const photoTestimonials: Testimonial[] = [
  { name: "Michelle, Google Places", quote: "You simply must experience this!!! Like the rater below… I saw this offer on Living Social… except that I didn't hesitate to grab it for even one second, and I am SO glad that I was able to experience this opportunity. I picked the Persistence of Memory piece to be painted on my front and Gulya truly transformed me into a work of art. She was personable, skilled and did an incredible job with the painting… she knew just how to customize the original painting to my brown skin tone and body type." },
  { name: "Nic, Google Places", quote: "AWESOME time for the ticklish… TOTALLY recommend this for anyone looking for something outrageous to do! Not something that I had ever thought about but when the offer came up on LivingSocial, I grabbed it! I am a plus size woman and the dragon came out fierce. Those that I showed couldn't tell if it was my front or my backside. Danny was a pleasure to work with, and kept me at ease the entire time." },
  { name: "Jennifer, Google Places", quote: "REALLY cool experience… I would recommend to anyone who is looking to just live and experience interesting things in life… you only live once so why not do interesting and fun things! I was very comfortable, nothing to be nervous or self conscious about… I am a photographer so I was able to contribute to the photo session as well, which was a lot of fun…" },
  { name: "Jessica, Google Places", quote: "It truly was an amazing experience. I also have been wanting to experience body painting for a while, and Den Art made it possible and, as most have mentioned, the environment was very comfortable. Def. recommending to friends, I'd do it again." },
  { name: "Elizabeth, Google Places", quote: "I loved this! I would definitely recommend this experience. The painting was beautiful and the photo shoot was so much fun. If you're thinking about doing it, you should definitely go for it." },
  { name: "Nance, Google Places", quote: "Would recommend to anyone!! I knew I wanted to do a body painting session as soon as I saw it, something in me told me I can do that! I had such a great time with the artists at DEN ART! The session was a very empowering experience and even though you are nude in front of people you barely know I still felt very comfortable." },
  { name: "Spencer, Google Places", quote: "This was FANTASTIC! I bought this as a gift for my wife and we absolutely loved the experience. I was able to see her transformed into a work of art as a living canvas. Danny was excellent in doing the painting and the photography. It provided an excellent memory for my wife and I to share and the pictures look fantastic." },
  { name: "Debbie Abazia", quote: "Thank you! You certainly made me more beautiful than ever. You're the best!" },
  { name: "Helen Shpits", quote: "Thanks for the pics and the amazing opportunity. I absolutely loved every minute of it" },
  { name: "Kindra M (Yelp)", quote: "Danny is one of the most talented and professional artists and photographers i have ever worked with. He put me right at ease when doing my body paint and his recreation of Dali's temptation of st.anthony was just amazing. I would work with him again anytime he wanted to." },
  { name: "Cristina L (Yelp)", quote: "Such a pleasure to work with. Danny is an extremely gifted painter and i felt honored to be his canvas. I had Van Gogh's Starry Night painted on my body and Danny was very professional and very respectful and it turned out beautifully. Thanks Danny!" },
  { name: "DI, Google Places", quote: "I absolutely LOVED my experience at DenArt. Danny is an amazing talent. His painting of the Spanish dancer was so beautifully done and detailed. The photo session was also a lot of fun and we got so many great pictures. Everyone at DenArt is so wonderful and professional." },
  { name: "Francesca, Google Places", quote: "I had an amazing experience at Den Art. I thought I might be self conscious of being undressed and of posing for pictures but everyone made me feel so comfortable and was so professional that I immediately felt at ease and thoroughly enjoyed the whole experience. My husband was blown away by the painting and photographs." },
  { name: "Cleone P (Yelp)", quote: "Den Art is definitely an experience that i would recommend! Danny makes you feel totally at ease and his talent makes the painting come to life on your body! It's something not only fun but a memory and pictures you can keep forever." },
  { name: "C D (Yelp)", quote: "I didn't think I would feel comfortable being completely nude, but Danny was extremely professional and made me feel at ease. A once in a lifetime experience!" },
  { name: "Kimberly S (Yelp)", quote: "This was the best time that I have ever had naked in front of strangers! Last year I saw a Living Social deal for the body painting/photo shoot package and immediately convinced my boyfriend to get painted with me. We finally went last night and it was awesome!" },
  { name: "Meg M (Yelp)", quote: "I bought the body painting session for my husband and I to do together and it was amazing. Danny and his crew made us (who are eligible for AARP) feel great, sexy and joyous. They are incredibly talented and caring artists. The experience is liberating and a lot of fun." },
  { name: "Alexandria H, Google Places", quote: "GO DO THIS!!!!!!! You must try this. Danny and his staff are very professional and kind and made this a relaxing fun experience. I can't wait to do this again. My photos came out great and I even purchased additional." },
  { name: "Melissa F (Yelp)", quote: "Danny was awesome to work with and made me feel very relaxed and comfortable. I loved my body art so much that it inspired me to get the tattoo I've been hesitating on. I'm def going back!" },
  { name: "Ashley P (Yelp)", quote: "Awesome experience! Danny and his team were very professional. It was so much fun and I left there feeling sexy and confident. Never in my life did I think I'd do something like this and I wasn't sure what to expect. It turned out to be such an amazing experience." },
  { name: "Sheryl S (Yelp)", quote: "Our experience at Den Art was amazing from start to finish. My boyfriend and I decided to do a couples nude body painting session and had an idea of what we wanted painted. We arrived at the studio as someone else was finishing their session. Danny and his partner were very thoughtful and collaborative." },
  { name: "Ashley C (Yelp)", quote: "Such a great experience that every one should try and a real ego booster. I chose a Asian inspired dragon on my back and couldn't believe how good and quickly it was done. Danny and his assistant were very nice and made sure I was comfortable every step along the way. Love how everything came out." },
  { name: "Anonymous (Groupon)", quote: "I purchased a groupon for a bodypainting experience at DenArt awhile back and found out i was pregnant shortly after. DenArt was kind enough to push back the expiration date just a bit so i could do the experience when I was 8months pregnant. We did the tree of life which was perfect." },
  { name: "Danny (Google)", quote: "Danny is excellent. I came with a friend today who wanted to get painted and try something new. He was very friendly, helpful and really comforting overall. My friend was a little nervous, but he was open, not creepy, and made the whole process so fun. I highly recommend this place." },
  { name: "Anonymous (Google)", quote: "What great fun this was! My gf and I had an hour session with Danny. I had butterfly wings painted on my back and flowers and dragon fly painted on my stomach- it turned out amazing. I loved the pictures taken as well! Highly recommended" },
];

// Process testimonials to add source badges
const processedEventTestimonials = eventTestimonials.map(t => ({
  ...t,
  ...extractSource(t.name)
}));

const processedPhotoTestimonials = photoTestimonials.map(t => ({
  ...t,
  ...extractSource(t.name)
}));

const TRUNCATE_LENGTH = 200;
---

<BaseLayout title="Customer Reviews" description="Read what our clients say about their body painting experiences at DenArt studio.">
	<main class="max-w-4xl mx-auto section-loose px-6">
		<SectionHeader
			title="Customer"
			titleAccent="Reviews"
			subtitle="Hear from our happy 'canvases' about their body painting experiences."
			centered={true}
			class="mb-16"
		/>

		<!-- Rating Summary - Prominent Placement -->
		<div class="mb-20 bg-gradient-to-br from-white/10 to-white/5 rounded-2xl p-8 border border-white/10">
			<div class="text-center mb-8">
				<h2 class="text-3xl md:text-4xl font-display text-sand mb-4">What Our Clients Say</h2>
				<p class="text-sand/60">Reviews from across the web</p>
			</div>
			
			<div class="flex flex-wrap items-center justify-center gap-6 md:gap-10">
				<a href="https://www.yelp.com/biz/denart-body-painting-studio-brooklyn-3" 
				   class="flex flex-col items-center gap-2 group p-4 rounded-xl hover:bg-white/5 transition-all duration-300" 
				   target="_blank" rel="noopener">
					<div class="flex gap-0.5">
						<span class="text-3xl text-yellow-400 drop-shadow-lg">★</span>
						<span class="text-3xl text-yellow-400 drop-shadow-lg">★</span>
						<span class="text-3xl text-yellow-400 drop-shadow-lg">★</span>
						<span class="text-3xl text-yellow-400 drop-shadow-lg">★</span>
						<span class="text-3xl text-yellow-400/70 drop-shadow-lg">★</span>
					</div>
					<div class="flex items-center gap-2">
						<span class="text-2xl font-bold text-sand group-hover:text-white transition-colors">4.8</span>
						<span class="text-sand/60 text-sm">(38 Yelp reviews)</span>
					</div>
				</a>
				
				<div class="w-px h-16 bg-white/20 hidden md:block"></div>
				
				<a href="https://www.google.com/maps/search/denart+body+painting+brooklyn" 
				   class="flex flex-col items-center gap-2 group p-4 rounded-xl hover:bg-white/5 transition-all duration-300" 
				   target="_blank" rel="noopener">
					<div class="flex gap-0.5">
						<span class="text-3xl text-yellow-400 drop-shadow-lg">★</span>
						<span class="text-3xl text-yellow-400 drop-shadow-lg">★</span>
						<span class="text-3xl text-yellow-400 drop-shadow-lg">★</span>
						<span class="text-3xl text-yellow-400 drop-shadow-lg">★</span>
						<span class="text-3xl text-yellow-400 drop-shadow-lg">★</span>
					</div>
					<div class="flex items-center gap-2">
						<span class="text-2xl font-bold text-sand group-hover:text-white transition-colors">5.0</span>
						<span class="text-sand/60 text-sm">(Google reviews)</span>
					</div>
				</a>
			</div>
		</div>

		<!-- Event Reviews Section -->
		<div class="mb-20">
			<div class="text-center mb-10">
				<div class="flex items-center justify-center gap-4 mb-6">
					<div class="h-px w-16 bg-gradient-to-r from-transparent to-brand-red/50"></div>
					<span class="text-brand-red text-xl">✦</span>
					<div class="h-px w-16 bg-gradient-to-l from-transparent to-brand-red/50"></div>
				</div>
				<h2 class="text-3xl md:text-4xl font-display text-sand mb-3">Event Clients</h2>
				<p class="text-sand/60">Corporate events, private parties & special occasions</p>
			</div>
			
			<div class="grid gap-6">
				{processedEventTestimonials.map((item) => (
					<article class="review-card bg-white/5 rounded-xl p-6 border border-white/10 hover:border-brand-red/40 hover:bg-white/8 transition-all duration-300 group">
						<blockquote>
							<p class="quote text-base md:text-lg text-sand/80 leading-relaxed mb-4">
								"{item.quote.length > TRUNCATE_LENGTH ? (
									<>
										<span class="quote-truncated">{item.quote.slice(0, TRUNCATE_LENGTH)}...</span>
										<span class="quote-full hidden">{item.quote}</span>
										<button class="read-more ml-2 text-brand-red hover:text-white text-sm font-medium underline underline-offset-4 transition-colors" type="button">Read more</button>
									</>
								) : (
									item.quote
								)}"
							</p>
							<footer class="flex items-center gap-3">
								<span class="w-10 h-px bg-brand-red"></span>
								<span class="text-sm font-medium text-sand">{item.displayName}</span>
								<span class={`source-badge px-2 py-0.5 rounded text-xs font-semibold uppercase tracking-wider ${
									item.source === 'Yelp' ? 'bg-red-500/20 text-red-400' :
									item.source === 'Google' ? 'bg-blue-500/20 text-blue-400' :
									item.source === 'Groupon' ? 'bg-green-500/20 text-green-400' :
									'bg-gray-500/20 text-gray-400'
								}`}>{item.source}</span>
							</footer>
						</blockquote>
					</article>
				))}
			</div>
		</div>

		<!-- Photo Shoot Reviews Section -->
		<div class="mb-20">
			<div class="text-center mb-10">
				<div class="flex items-center justify-center gap-4 mb-6">
					<div class="h-px w-16 bg-gradient-to-r from-transparent to-brand-purple/50"></div>
					<span class="text-brand-purple text-xl">✦</span>
					<div class="h-px w-16 bg-gradient-to-l from-transparent to-brand-purple/50"></div>
				</div>
				<h2 class="text-3xl md:text-4xl font-display text-sand mb-3">Photo Shoot Clients</h2>
				<p class="text-sand/60">Body painting sessions & creative photo experiences</p>
			</div>
			
			<div class="grid gap-6">
				{processedPhotoTestimonials.map((item) => (
					<article class="review-card bg-white/5 rounded-xl p-6 border border-white/10 hover:border-brand-purple/40 hover:bg-white/8 transition-all duration-300 group">
						<blockquote>
							<p class="quote text-base md:text-lg text-sand/80 leading-relaxed mb-4">
								"{item.quote.length > TRUNCATE_LENGTH ? (
									<>
										<span class="quote-truncated">{item.quote.slice(0, TRUNCATE_LENGTH)}...</span>
										<span class="quote-full hidden">{item.quote}</span>
										<button class="read-more ml-2 text-brand-purple hover:text-white text-sm font-medium underline underline-offset-4 transition-colors" type="button">Read more</button>
									</>
								) : (
									item.quote
								)}"
							</p>
							<footer class="flex items-center gap-3">
								<span class="w-10 h-px bg-brand-purple"></span>
								<span class="text-sm font-medium text-sand">{item.displayName}</span>
								<span class={`source-badge px-2 py-0.5 rounded text-xs font-semibold uppercase tracking-wider ${
									item.source === 'Yelp' ? 'bg-red-500/20 text-red-400' :
									item.source === 'Google' ? 'bg-blue-500/20 text-blue-400' :
									item.source === 'Groupon' ? 'bg-green-500/20 text-green-400' :
									'bg-gray-500/20 text-gray-400'
								}`}>{item.source}</span>
							</footer>
						</blockquote>
					</article>
				))}
			</div>
		</div>
	</main>
</BaseLayout>

<script>
	// Read more / Read less functionality
	document.querySelectorAll('.read-more').forEach(button => {
		button.addEventListener('click', function() {
			const card = this.closest('.quote');
			if (!card) return;
			
			const truncated = card.querySelector('.quote-truncated');
			const full = card.querySelector('.quote-full');
			
			if (truncated && full) {
				if (truncated.classList.contains('hidden')) {
					// Collapse
					truncated.classList.remove('hidden');
					full.classList.add('hidden');
					this.textContent = 'Read more';
				} else {
					// Expand
					truncated.classList.add('hidden');
					full.classList.remove('hidden');
					this.textContent = 'Show less';
				}
			}
		});
	});
</script>