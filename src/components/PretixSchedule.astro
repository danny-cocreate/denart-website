---
import { fetchSubeventsForSlug } from '../utils/pretix';
import EventCard from './EventCard.astro';

interface Props {
  eventSlug?: string;
}

const { eventSlug = 'uc-class-couples-2' } = Astro.props;

// Fetch events for the specified slug
const events = await fetchSubeventsForSlug(eventSlug);
const upcomingEvents = events.slice(0, 6);
---

<div class="pretix-schedule" data-events={JSON.stringify(upcomingEvents)}>
  {upcomingEvents.length > 0 ? (
    <div class="flex flex-col gap-2">
      {upcomingEvents.map((event) => (
        <EventCard event={event} variant="compact" showArrow={false} />
      ))}
      <a 
        href="/calendar"
        class="text-gray-500 text-xs py-1 hover:text-brand-red transition-colors"
      >
        + View all dates
      </a>
    </div>
  ) : (
    <p class="text-gray-400 text-sm">Check calendar for upcoming dates</p>
  )}
</div>